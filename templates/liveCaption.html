{{define "liveCaptionPage"}}
<!DOCTYPE html>
<html>
	<head>
		{{template "header"}}
		<script>
			var styleSheet

			$(window).load(function () {
				styleSheet = $($("iframe").contents()[0].styleSheets).last()[0].rules

				// // following need to be implemented
				// //color
				// styleSheet.addRule(		"body.presentation .gurmukhifont", 		"color: #FFEB3B")
        //
				// //font-size
				// styleSheet.addRule(		"body.presentation .gurmukhifont", 		"font-size: 10vh")
				// styleSheet.addRule(		"body.presentation .gurmukhifont", 		"line-height: 14.5vh ")
				// //styleSheet.addRule(		"body.presentation .gurmukhifont", 		"line-height: (font-size)*1.34 ")
        //
				// //shadows
				// //if requiring green screen to cut out of frame
				// styleSheet.addRule(		"body.presentation .gurmukhifont", 		"text-shadow: 0.5vh 0.5vh black")
				// //if no green screen (proper transparent web page is available, default)
				// styleSheet.addRule(		"body.presentation .gurmukhifont", 		"text-shadow: 0.5vh 0.5vh 2vh black")
        //
				// //background (only works on gurmukhi right now, others need to be in div like english is now, and have the text in a span inside that is set to display inline)
				// // omit 80 or change 80 to FF for opaque / removing semi-transparency
				// // styleSheet.addRule(		"body.presentation .active .gurmukhifont > div > div", 		"background: #00000080")
        //
				// //window
				// // styleSheet.addRule(		"body.presentation .gurmukhifont", 		"background: #00000080")

				$("input").click(function() {
					var settingName = this.id
					var item, property, value
					var selector = "body.presentation "
					var setting = this.type == "checkbox" ? $(this).prop('checked') : this.value
					switch (settingName) {
						case "position-top":
							selector += ".line > div"
							property = "justify-content"
							value = "flex-" + (setting ? "start" : "end")
							break;
						case "gurbani":
							selector += ".gurmukhifont"
							property = "display"
							value = setting ? "block" : "none"
							break;
						case "english-translation":
							selector += ".translation"
							property = "display"
							value = setting ? "block" : "none"
							break;
						case "punjabi-translation":
							selector += ".darpan"
							property = "display"
							value = setting ? "block" : "none"
							break;
						case "english-transliteration":
							selector += ".transliteration"
							property = "display"
							value = setting ? "block" : "none"
							break;
					}
					for (var x = 0; x < styleSheet.length; x++) {
						if (styleSheet[x].selectorText == selector) {
							styleSheet[x].style[property] = value
						}
					}
				});

				$(".chooser").click(function() {
					$(".popup", this).toggle()
					$(this).siblings().children(".popup").hide()
				})

				$("#copy-css").click(function() {
					var cssString = ""
					$(styleSheet).each(function (index) {
						cssString += this.cssText + "\n"
					})
					alert(cssString)
				})

				$("#copy-link").click(function() {
					alert(window.location.origin+'/obs')
				})

				$("#save-default").click(function() {
				})

			})

			function iFrameResize() {
				var w = $('div.preview').width();
				var h = $('div.preview').height();
				// 16/9 = 1.777 recurring
				if (w/h >= 1.7777777) {
					//element is too wide to fit preview, size preview to max-height and trim width
					w = h * 16 / 9;
				} else {
					//opposite logic
					h = w / 16 * 9;
				}
                $('div.preview > iframe').height(h);
                $('div.preview > iframe').width(w);
			}
			$(document).ready(iFrameResize);
			$(window).resize(iFrameResize);

            $(function () {
                $("#english-translation").prop('checked', true)
				$("#gurbani").prop('checked', true)
        	});
		</script>
    </head>
<html>
	<body class="liveCaption {{.Theme}}">
		{{template "dragBorders"}}
		{{template "titlebarCloseable" .}}
		<div class="titlebaroffsetissue"></div>
		<div class="preview">
      		<iframe src="obs" width="1280" height="720" class="iframe"></iframe>
		</div>
		<div class="settings">
			<div class="c1">
				<p>Macro</p>
				<div>
    			<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="position-top">
            	<input type="checkbox" id="position-top" class="mdl-switch__input">
            	<span class="mdl-switch__label">Top Captions</span>
        	</label>
        	<p style="margin-top: .75em;">Margins</p>
        	<p style="width:100%; ">
            	<input id="margin" class="mdl-slider mdl-js-slider" type="range" min="0" max="10" value="10" step="1">
        	</p>
        	<p style="margin-top: .75em;">Width</p>
        	<p style="width:100%; ">
            	<input id="width" class="mdl-slider mdl-js-slider" type="range" min="50" max="100" value="100" step="1">
        	</p>
        	<p style="font-size: 0.85em; margin-top: .75em;">The following setting is for broadcasting programs that lack support for transparent backgrounds. Modern broadcasting programs, including OBS, support transparency. Please see the tutorial for more information.</p>
    			<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="green-screen">
            	<input type="checkbox" id="green-screen" class="mdl-switch__input">
            	<span class="mdl-switch__label">Green Screen</span>
        	</label>
				</div>
			</div>
			<div class="c2">
				<p>Appearance</p>
				<div>
        	<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="gurbani">
            	<input type="checkbox" id="gurbani" class="mdl-switch__input">
            	<div id="font-color" class="chooser"></div>
            	<span class="mdl-switch__label">Gurbani</span>
        	</label>
					<div class="options">
						<div class="chooser">
							<span class="label">C</span>
							<div class="popup color">
								<div class="fixed-color-choices">
									<div class="white"></div>
									<div class="black"></div>
									<div class="red"></div>
									<div class="pink"></div>
									<div class="purple"></div>
									<div class="deep-purple"></div>
									<div class="indigo"></div>
									<div class="blue"></div>
									<div class="light-blue"></div>
									<div class="cyan"></div>
									<div class="teal"></div>
									<div class="green"></div>
									<div class="light-green"></div>
									<div class="yellow"></div>
									<div class="amber"></div>
									<div class="orange"></div>
									<div class="deep-orange"></div>
									<div class="brown"></div>
								</div>
								<div class="custom-color">
									Custom: <input type="color">
								</div>
							</div>
						</div>
						<div class="font-size-changer">
							<div class="smaller">-</div>
							<div class="value">2.25vh</div>
							<div class="larger">+</div>
						</div>
						<div class="chooser">
							<span class="label">S</span>
							<div class="popup shadow">
								<div class="remove-option">
									<div>None</div>
								</div>
								<div class="fixed-color-choices">
									<div class="white"></div>
									<div class="black"></div>
								</div>
								<div class="semitransparent">
									<label class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect" for="checkbox-2">
									  <input type="checkbox" id="checkbox-2" class="mdl-checkbox__input">
									  <span class="mdl-checkbox__label">Semitransparent</span>
									</label>
								</div>
							</div>
						</div>
						<div class="chooser">
							<span class="label">B</span>
							<div class="popup background">
								<div class="remove-option">
									<div>None</div>
								</div>
								<div class="fixed-color-choices">
									<div class="white"></div>
									<div class="black"></div>
								</div>
								<div class="semitransparent">
									<label class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect" for="checkbox-2">
									  <input type="checkbox" id="checkbox-2" class="mdl-checkbox__input">
									  <span class="mdl-checkbox__label">Semitransparent</span>
									</label>
								</div>
							</div>
						</div>
						<div class="chooser">
							<span class="label">W</span>
							<div class="popup window">
								<div class="remove-option">
									<div>None</div>
								</div>
								<div class="fixed-color-choices">
									<div class="white"></div>
									<div class="black"></div>
								</div>
							</div>
						</div>
					</div>
        	<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="english-translation">
            	<input type="checkbox" id="english-translation" class="mdl-switch__input">
            	<span class="mdl-switch__label">English Translation</span>
        	</label>
        	<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="punjabi-translation">
            	<input type="checkbox" id="punjabi-translation" class="mdl-switch__input">
            	<span class="mdl-switch__label">Punjabi Translation</span>
        	</label>
        	<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="english-transliteration">
            	<input type="checkbox" id="english-transliteration" class="mdl-switch__input">
            	<span class="mdl-switch__label">English Transliteration</span>
        	</label>
				</div>
			</div>
			<div class="c3">
				<p>Controls</p>
				<div>
          <button id="copy-link" class="mdl-button mdl-js-button mdl-js-ripple-effect">
            Copy Link
          </button>
          <button id="copy-css" class="mdl-button mdl-js-button mdl-js-ripple-effect">
            Copy CSS
          </button>
          <button id="save-default" class="mdl-button mdl-js-button mdl-js-ripple-effect">
            Save Default
          </button>
          <button class="mdl-button mdl-js-button mdl-js-ripple-effect">
            Help
          </button>
          <button class="mdl-button mdl-js-button mdl-js-ripple-effect">
            Reset
          </button>
          <button class="mdl-button mdl-js-button mdl-js-ripple-effect">
            Exit
          </button>
				</div>
			</div>
		</div>
	</body>
</html>
{{end}}
